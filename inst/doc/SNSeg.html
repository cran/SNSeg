<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to SNSeg and Examples</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SNSeg and Examples</h1>



<p>SNSeg supports change-points estimation for both univariate and
multivariate time series (including high-dimensional time series with
dimension greater than 10.) using Self-Normalization (SN) based
framework. Please read Zhao, Jiang and Shao (2022)
&lt;doi.org/10.1111/rssb.12552&gt; for details of the SN-based
algorithms.</p>
<p>The package contain three functions for change-points estimation:</p>
<ul>
<li>The function <code>SNSeg_Uni</code> works for a univariate time
series.</li>
<li>The function <code>SNSeg_Multi</code> works for multivariate time
series with dimension up to ten.</li>
<li>The function <code>SNSeg_HD</code> works for high-dimensional time
series with dimension above ten.</li>
</ul>
<p>All functions contain two important input arguments:
<code>grid_size_scale</code> and <code>grid_size</code>.</p>
<ul>
<li><code>grid_size_scale</code>: the trimming parameter <span class="math inline">\(\epsilon\)</span>, a parameter to control the
local window size <code>grid_size</code>. The range of
<code>grid_size_scale</code> should be between 0.05 and 0.5. Any input
<code>grid_size_scale</code> smaller than 0.05 will be automatically
changed to 0.05, and any input <code>grid_size_scale</code> greater than
0.5 will be automatically changed to 0.5.</li>
<li><code>grid_size</code>: the local window size <span class="math inline">\(h\)</span> for local scanning for each time point.
According to Zhao et al. (2022), <code>grid_size</code> is a product of
<code>grid_size_scale</code> and the length of time.</li>
</ul>
<p>Users can set their own <code>grid_size</code> or leave it as
<code>NULL</code> in the input arguments. If <code>grid_size</code> is
<code>NULL</code>, these functions will compute the SN test statistic
using the value of <code>grid_size_scale</code>. If
<code>grid_size</code> is set by users, the functions will first
calculate <code>grid_size_scale</code> by diving the length of time, and
then compute the SN test statistic.</p>
<p>For the other input arguments: * <code>ts</code>: Users should enter
a time series for this argument. For <code>SNSeg_Uni</code>, the
dimension of <code>ts</code> should be exactly one in most cases (or two
when <code>paras_to_test = &#39;bivcor&#39;</code>); for
<code>SNSeg_Multi</code>, the dimension must be at least two but no more
than ten; for <code>SNSeg_HD</code>, the dimension must be greater than
ten. * <code>paras_to_test</code>: This argument in functions
<code>SNSeg_Uni</code> and <code>SNSeg_Multi</code> allows users to
enter the parameter(s) they would like to test the change in. *
<code>confidence</code>: Users should choose a confidence level among
0.9, 0.95, 0.99, 0.995 and 0.995. A smaller confidence level is easier
to reject the null hypothesis and detect a change-point.</p>
<p>The package also offers an option to plot the time series (this only
works for the univariate time series cases!) Users need to set
<code>plot_SN = TRUE</code> to visualize the time series, and
<code>est_cp_loc = TRUE</code> to add the estimated change-point
locations in the plot.</p>
<div id="sn-test-statistic-plot-max_snsweep" class="section level2">
<h2>SN Test Statistic Plot: <code>max_SNsweep</code></h2>
<p>To visualize the computed SN-based test statistic at each time point,
users can apply the function <code>max_SNsweep</code> by plugging in the
output object from one of the functions <code>SNSeg_Uni</code>,
<code>SNSeg_Multi</code> and <code>SNSeg_HD</code>. The options
<code>est_cp_loc = TRUE</code> and <code>critical_loc = TRUE</code> are
provided to draw the estimated change-point locations and the critical
value threshold inside the test statistic plot.</p>
<p><code>max_SNsweep</code> also returns the SN-based test statistic for
each time point. A large number of test statistics in the output can be
messy for users who only seek to generate a plot. To hide the test
statistics output, users can create an arbitrary variable name and set
it to the <code>max_SNsweep</code> function, e.g.,
<code>SN_stat &lt;- max_SNsweep(...)</code>.</p>
</div>
<div id="parameter-estimates-of-each-segment-separated-by-the-detected-change-points-snseg_estimate" class="section level2">
<h2>Parameter Estimates of Each Segment Separated by the Detected
Change-Points: <code>SNSeg_estimate</code></h2>
<p>The function <code>SNSeg_estimate</code> allows users to compute the
parameter estimates (e.g., mean, variance, acf, quantile, etc.) of each
of the segments separated by the estimated change-points. To use this
function, users should use the output of the functions
<code>SNSeg_Uni</code>, <code>SNSeg_Multi</code> and
<code>SNSeg_HD</code> as the input of <code>SNSeg_estimate</code>.</p>
</div>
<div id="s3-methods-summary-print-and-plot" class="section level2">
<h2>S3 methods: summary, print and plot</h2>
<p>The typical S3 methods <code>summary</code>, <code>print</code> and
<code>plot</code> are available to <code>SNSeg_Uni</code>,
<code>SNSeg_Multi</code> and <code>SNSeg_HD</code> objects. The
<code>summary</code> method displays the parameter to be tested, the
estimated change-point amount and locations, the <code>grid_size</code>,
confidence level as well as the critical value of the SN-based test. The
<code>print</code> method shows the change-point locations. The
<code>plot</code> method plots the time series, and similar to the
argument <code>plot_SN = TRUE</code>, the <code>plot</code> method
allows users to generate time series segmentation plot(s) with the
estimated change-point locations. It also provides <code>n_plot</code>
option to allow users to generate any number of plots they want. Users
can apply their preferred color of the change-point(s) within the
plot(s) by setting <code>cpts.col</code> to any color.</p>
<p>We then provide the examples of the functions <code>SNSeg_Uni</code>,
<code>SNSeg_Multi</code> and <code>SNSeg_HD</code>.</p>
</div>
<div id="examples-of-snseg_uni" class="section level2">
<h2>Examples of <code>SNSeg_Uni</code>:</h2>
<p>The function <code>SNSeg_Uni</code> detect change-points for a
univariate time series based on the change in a single or
parameters.</p>
<ul>
<li>For a univariate time series, the input argument
<code>paras_to_test</code> allows one or a combination of multiple
parameters from “mean”, “variance”, “acf” and a numeric quantile value
between 0 and 1. For instance, to test the change in autocorrelation and
80th quantile, users should set <code>paras_to_test</code> to c(‘acf’,
0.8).</li>
<li>To test the change in correlation between two univariate time
series, the input time series must be two-dimensional and
<code>paras_to_test</code> should be set to <code>bivcor</code>.</li>
<li>Users can also set <code>paras_to_test</code> using their own
parameters. In this case, the input of <code>paras_to_test</code> needs
to be a function which returns a numeric value.</li>
</ul>
<p>We provide examples for different cases:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please run the following function before running examples:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mix_GauGPD <span class="ot">&lt;-</span> <span class="cf">function</span>(u,p,trunc_r,gpd_scale,gpd_shape){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  indicator <span class="ot">&lt;-</span> u<span class="sc">&lt;</span>p</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  rv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(u))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  rv[indicator<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">qtruncnorm</span>(u[indicator<span class="sc">&gt;</span><span class="dv">0</span>]<span class="sc">/</span>p,<span class="at">a=</span><span class="sc">-</span><span class="cn">Inf</span>,<span class="at">b=</span>trunc_r)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  rv[indicator<span class="sc">&lt;=</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">qgpd</span>((u[indicator<span class="sc">&lt;=</span><span class="dv">0</span>]<span class="sc">-</span>p)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p), <span class="at">loc=</span>trunc_r, <span class="at">scale=</span>gpd_scale,<span class="at">shape=</span>gpd_shape)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rv)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="test-in-a-single-parameter" class="section level2">
<h2>Test in a single parameter</h2>
<div id="segmentation-for-mean" class="section level3">
<h3>Segmentation for Mean</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>)),<span class="dv">1</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, reptime, rho)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span>   </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,] <span class="sc">+</span> mean_shift[index]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined &amp; generate time series segmentation plot</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">116</span>, </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZjqQkDqQkGaQkLaQtpCQttuQ29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb/9vb////AAD/tmb/25D/27b//7b//9v////6CpUVAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQSUlEQVR4nO2dC2PbthHH4dSZ3WWP2EvbxcnWdVa3xau1Jlsox8b3/1wj8bzD6wASkijn/lsdiTwcgB8PB5CiKCFZRYljN2DtYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGREgBevrnKyHO/njXw+HTP+7jDU/vxMvP9S5ia+/16edLIV5TRR+vxQXlk652qlXoPUpnN5U9KOjLmxf38YalgIDX3dTSK6poF0Cq1gnQVhgFfZujTegk2kAr7gxwshVnt3TRCNAcqVqFenH2duQ1xtEUQk8/j7H0WjVwenl+O9lNFX58Ndn953LcJJHd2Oa/K8vJleb88c347+/dhl9Muz9+J8Q33wdlXGv+Ne49v/O9dNYbf/TUywkRcvW3N+LFXQwIVKJ2GM471VHXROvggy4bNF344/NwOYXu6HrS+b0demevNCCtV7atwM5G4Nhu05VdsMEAMobgpQ+Hjd/wFFonAEWudMyFgLBPTWb0Mdr4JloH/3uHt3tAo8HZ9x/8kbwzrEbbi89PG2EAXclfxxJvJ/MrZLdVB95tVinnN5/NTrvhpdow/tV2sIwFNDoca7hIWEdDLHD18k7+NzHEQCVqx/jnQu27Qk00DqwJbjpI0uc/fTalpzLjvo0NFQVorFj/VaWh3VYdmHHzBejKp2lmvECAzL5NWMYCujE7Y+sIUOxKpgHZSvQO01wTtraJxoFLfajpeh306ys7XkZvNsZsAZuDbLUKELAzNeqduuVP7/VOBMj624ZlfEbUO2PrEFDCVRqQq8RF5Y0xAU00DvSOsOl2ofj06a+X09adcB23rU8CAnYxoCkkz3/8dI0BWX8qE+QATTtj6xBQwpVzUwI0jTE9fGATIaCo6cImZ9PGiXFwNHIR5OI6AuTS/cEjCEw4KUDTGPuLTWJXmKM2iZou1LuzH6b57dKRgJXZHIQBQbsI0M6O/atCDooAzc9BANBWzWfTzHKVAqQyw/QCNhECipqOFoq6h+Ni58u1mfHALIYBQTvYWfVazTHTuuoCHXE89cSA8rMYYJCaxQAgOPQTgNTcfSNl3EQfQXg7PNWA65uz23AdFAACdrCzO7PsccDthmgdFAOybYjWQdrJPQAUu5KBn9cyCWhnHD2BJoY5CDVdn6yqWUyvS+WX92MY6hPXabH8h7tkDoJ2sLNq8X03TQXnP6lJVW34ANfGP4TD0o7nX95rh0+RtfYKAUWunHRf3gaVROcgoInRLAabXnG5Y9NyojlbM87ZDqISoI0KVLCY26dOEZBNeKXT5246RUDyy3eX3S6kUTpJQCwGRIoBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEeoMSOxFQzcjr2MB6uvOaKg02ke/nxMg0dCArxGQaGnBcwGkBw0DKrkTDIjwJjgHlb1VA/r6ZrFWQM2uexoezV11Dmr23NfwKO6aZrE2x90Nj+LOiAERagNUlapXC6hhovEaakpaQHWT/VoBtSxVvIaakgNsAX2gauueA+jhMvsMi5Q7cOibFru+6FBTsgjItcG+2Asg93QBkX2KRcIdPPSJxpVGji3aBmjy6A2Vf9cG9KJKTRG009/+bYog1LO4m4WRY9CJNkCBR/XOFRYJC0JtQ+zxWn8zNgSUvVAXRnTYtkK/bSCIhhykWgDbIfDfvQOScqO+s1sbQcIcPhsMEcM8IF1U+JV0ZiwaJC7MhK9VJgAB7HVqTtJbcVUNSI9/IU0aiMKnkDEdV2IlbcyEMGfzhqPAaA6Vg5QeLr+pBGS52PAJ06eETQ8dCRcaJUAuPIUYHA2Xl6Uj4vLZ/iNIfTu4CpBtiXANlz72JeiOLyFAh8FAqQAkhY8gA8h5Eygc95yDGty5bADjHALCAWUb7qh6dgBQIoc5QDb5gDgRboDj6WwtgHwKNX0GHUQIfFnTO+FmRgkBRX3z08DgHQI+MP/ZuAwbWt2jDgpyEAxvm1ZcdoCDyJcFgSbM/8B5aLYSlYOEHc9m/oN/7Wa/uprRo+VKtN1PvgK01adhF2Y4VfmS/oqiwEGCrOUAHdrMjAAJj/zogBwbBwV3W0p0rGHCENJhs/b+LEIaQg66j6rBz3x+xrIjXABgYMg19KiTbOdt84Q7jG4OQ9OYsBM9HII+SEzxAdl7kCDPqwhyu3F5NMxXAQgcajeR+G2ekEtJLvRd2oB8xeDSBggKCF1qI+F8AvmqQHXHBSQ8Gpw17GZnbSMKdAkfeWEiCA1DhMYmNzkAFyDVoIASoMaWHvWTbxRKIujgg/bqMnCPPcAIkT/N8hESlnO3v0i/SrD2AfamfvcHFHXPUpLwjZ9PJLIKDre2HbClSz4g5YT3B/mdSf/HBSRwuMRNBZMcTDj2aNtc5LYOtleui24y8+6CG6h8+bDaNQACPdEtErHgvB4c4dB0iDOJAEEibQQFBV1aDus4LqAEDJSFYe/C8I/tNKDQFrCMclBggV/5KXAGIPUg0k32Uc317hKERBgrwTyV7Jvve6qv4QgKc5CUWULzAO3ObrfTAzAXEfLzUowpkY5TZgkKg09UOcTZmzjDwJNzc9DTuyu5nZ5NuOhBUHDizinYX7aWdoJKe3UJRkZJWmKkEu2ZAejx+kYB2s0BJILaC/0llcg1+fRSykFhGTiJLYigzaJnAmZyUKI/LXJ9L0XRALeEFujdPEAmB23zl1Nr3WV7InIDpSw9eoIcHysfQbhSOTMHmQ9OFz4S0J0HVXS7diM6iwAvAtjeKDE/BG/XcC5W6G/V3lTfcdFgOdrwVYRjA2pXdkTqf4YamFlAqQXHrFnMlF4+zdOdadSiL7Mk+cyPoFmzPHaXadZs4SVOlv+Q5RFtWAJIbhY92dZcx2olUOx5IkmXjCrqWwRoWQilctDyYIquZFQYFbQMUIdTjXSrqtsfl+j9hbolgB6vFw+xaF1W3/K6vi+NICGWzGLLnj5uwnceh6y6fyXzuOug9izdpe+nBAhfdF+uWkDVdR0bUNCaJhiZvncyMmoGVHGDbwugXvNYsu+5EXxC52LdzzXaIoiu/tiAuqvjEDMXSuYAssOsNMTsD7tkbWadavTpe0OSngdo8/Lz9qJ0D7S6BVi/2OV+yHP1EaQ0C9D0ec9u+lQjv1KcLltbVBmrUwAk566kb+TDb+/VfxlNJkbBKS2offWApPmAvBXQFB6Pf7otAXouETQPkDqN31yVhph0H3mUc9ABpvlEFeFiKSf94fycaX5zoX+ur2BNntHCWawfp1Uk6T7qdk0aOekMqKnf9lSjww+FI0Bdg6gnIHvJqhWQ6PMra0f6VCP5AX7WeAYgvUbu8ENrewAk1xBBSvoHrzsAKt77M0f9AJm7g2Yn6d3Cqx1V9wc1yH2yWqH9R5Bh1ON6UN9RJteQgwydPhfta/rTohkRVFopzgXULQc1dr+1767/6dtfzP5CO2YB6jiLRU1PtbESjet78FlbwkfiVCO6PdG8bwfUdR2U6n3+lqHiWGi59cffvEDRnwWo40o6+jA1dVOeTLzCH8OC7SlAkdPcdzW6AOome7IaE0qlhNKhjvuOR1lUNvn5tFuSBYXXd7IabA8/v4/NC30PDaQzgmGFIxO9OTYgEDApDvgmRnBzkE/vUloPhRwU5LXiHWbwDPr4ESRTM5m0aNBCMogDd7FPoBgZErQjpS6YoXo8o+MDEglCsJ3SBQqIGr8FH+84OIJMXowg6SvzEXxsQP6MLDxxleD4WSB62gPjL51/k8xlmqJ08D1FW+PcTzWWcQEtBpgEnm7tKJPw0iwo7g+1z02g79mFQggoXirY4+L/riOCEgsgD8gOJFsCdARlKYm+L4bDIgSEZ8qAFKB+bEAyPFywlQCQhH9B69EYlTiC4lHmAcn4YOBiIB019qiX0CwWnnjIRBMBIDO7w31uiLlVQ2rdIJwRCiAJMzQaeC393hMgO4ZyS0drCyIOTWx4jA0i4cLNS9JFEI4eiUaVey1XEUH+pEx33XcfBI4Q2NzykbDjUwmfXuBICRLTACBKF2wg+bj2rAaQT7kCvklW6wLCG/h8PLgxi6JHouymnyXooEgJ8PjitvJjA/JdkH7KAhaFajEgRXcAwEGSwmE02A1ut+fnJwspVzHEQMT4d3ApQrowgPT/3YMm0cDFYaYe8uayMnIE6Ai8s75HvYRmbYkIgTRUrtSWdnO0f9BkkLr8IJT28ThoEvR/vXOR3Ez1qJvc/IyXY/awEWiQNcg2iWeYCZfxrdXg6giOS6Gh1T3qJtOD5jOesuKn4Jkog0N5ED7IrHX+gKwVUGUMBabRcxR9NX69fEo/PAJPKqLdlTVC0+hJnA6Q+UclqjiCyIb2NGxxJ1xiSO/NFQYlkGkOkJ/apBQr+m0f+mnAmUgpdwEVKgPyecivLFcAqPqR7blgL3YB7yQAhacpch05qPaR7VkQ9MQrUqZlQOZ4RD9+VJwQ9jTEco9sD9zlI4WceEXKND/EvKkIjcrxtLccVPfI9pZgR2XThbJJGr4bSibJyqpb1aS6R7Y3rHdA4cS8h1fSuJp1Ako+st0n72Z3gZtgg/7vtABVP7K9WdEYs50kc5CUq8lBEn1lo4e7oKxIbCFmMWlnsZJJsrLqVjVpFYBiref3xQ4HKJuDUnr+gFJZIzOLpfQVAMpmjRMDdEB3Rs8J0F70jH5vvs1p30sTvS90zDLv65QB9bFjQGs0m2ne1ykD6mPHgNZoNtO8r1MG1Mfu+QF6TmJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEeoPaFd8Soq+z/EC2pULlKQfitnVZaTugHZjy3b51j18exvYEQUKerxWt5L2dBmrNyD9uXT+513sA66cHVUgL/s8sY4uE+oNSN+el//1ku1FYEcVyGonrjSafi5T6g5IxXv+QWib3wn1nCtnRxUoSZfq6jJSb0B66GcTgL6PeHPl7YgC5comBn1dRjowIGP04r4foL4uIx16iGmjy5uOQ6yry0iHTtLa6NvbLhkVAurkMtKBp3nd9rFjXeZkBaivy0iHXiiqZk+/uN1jVWdmsZ4uI/U/1diWl/mbcU6+QXZEgYLMEOvpMhKfrBJiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYEKHVAXLPQ33x714/m7dIqwM0yd3YuwIxIEIrBjT9MuXD5Z+nX399uNQ3uGzF8p+CbdTqAZ3djlhe3Ks76rbqQbKHJbR6QNMN0PrPzeP1xKbTzZm1Wj2gG+n+6LvqCo/a3YdOCpBZADCgYgQdWKcEqNsPLrfolACpWUw9E/2AOilAah102ElsnYDWJAZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhBgQIQZEiAERYkCEGBAhBkSIARFiQIQYECEGRIgBEWJAhP4PsmZD0dOFvJkAAAAASUVORK5CYII=" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1018 1487</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (mean) of each segment</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $mean</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.39444849 0.02107613 0.38362925</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We then show how to use the S3 methods <code>summary</code>,
<code>print</code> and <code>plot</code>.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 2 change-point(s) detected at 90th confidence level based on the change in the single mean parameter.</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 135.39283594</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 1018,1487 with a grid_size of 116</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 1018,1487</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can see both the <code>plot_SN = TRUE</code> option and the
<code>plot.SN</code> function generates the same plot. Users can select
any choice based on their preferences. The class of the argument
<code>result</code> is <code>SNSeg_Uni</code>.</p>
</div>
<div id="segmentation-for-variance" class="section level3">
<h3>Segmentation for Variance</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_Variance</span>(<span class="dv">2</span>, <span class="st">&quot;V1&quot;</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;variance&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>, </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 401 738</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (variance) of each segment</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $variance</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.440844 5.572523 1.530858</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 2 change-point(s) detected at 90th confidence level based on the change in the single variance parameter.</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 141.8941189</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 401,738 with a grid_size of 51</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 401,738</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtrZmtv+QOgCQZgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///8MSX8PAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIy0lEQVR4nO3djXabuBYF4NMmvZPMJDeeuE5y3v9FxwJLSAKxJSEIuHuv1dS14YC+8I9qRJnZyHfPwN5DIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgjYHkMPkuoLbl1guBQAgEcidA63kTqFXlfbeIQNuWq6m87xYRqLbc4umsBHT6+a4fv0R+vDUpB3M0oM7nf1ecz+eXBuVwDgb0+fx0RXo0L88PvxeXy8jhgF706/XJvLxclyW/SvE5YN7MBeUk8bqudPMBTczSc95wCToc0Ofzz/duEbqkttJ/ONBVpl+RHhuVAzkg0LblCISqEQhUc+VECTRVjUCgGoFANbFFCTRdjUDzRXwgGQMtmdgdAgX7fIkXqeppNBtww3IRkBAoVYRAoMgYSPxPDgTU9noQBJIb0IKp3c8SJBCoapoEyp1GswE3LJcJJCmgnJnYCVBd9WHLQ6DJCgQCFUZA0v+Ubwb6fJaH36en3DFzpntXQJcfb+eH393NwfogIDxfuwUyt3PM3a5zeEuwMM2AZHdA5rapAbrcE5Akp1q/BJ0S90wLyyVmQ8avJfx3LtBwYhMzyTpAt23QWRL9NgrLjX+5knhjI6Da3Ue4F5vp+dPlfB2iA0xtqSaAxH/Hvy6YAhIPqMNxPxNAEf1qQDjnK9/ns7nv3ASoX0a8UfrBjwvUd335ep3Z130nkAx1g2k2AupWMJP0Xsz2K7tux8+of1A9kEAgCYBkDCQhUHCSErcbJR5wbi9/6zxl+gmhJUiKgaQJkFfBmwu3vW8AdOtiNx3Lcl3aioDsRiK8suyAbr/hpkDiz0VToNkDRXsQ8PWaBSQx0K2pw+xHQJIDJNVA3t21eqA2pxr9LKaBhoZmAkkGkHOwVV2thkD9Xrw6PpCUAnkoKwDZd6bbDVvk9mKLzjRGQN6a760sYyAJgcQD8jIB5Npsx14NqE3SQIKABhkM5L+RAJK9A9lWjn7vKwN5q6S/uvplDwQkziYfKH7DB/IrNQVyh9EydyRdCmQ5bLPmgMJGFQPJDFD45p6WIJ9DRu9AIMkAckOmgeKXcsdAkgM0qdICyK5m7Vex0doyA+Q3aCznA3k7prki7YDMOfqjfvxqcUUxtIjbGgBNLSgxkAoEKkglkLnfczFXehpck44spppvh5r8PAkk3wr0oh9/vXd/yl2iqY8bOwYaXk59nASS6E31x0hNsAWQudjz+fdbHVBcbn4O/fYkFp8k0IhhM6DuNP701GQVawGkDYGiLWAlkLlUlr4StjGQZAPFBSWkm/q4FqhFIJDX+OTmdV2gwnbbU41FO/cSIHdloxoobr/l1mjQ4WULoJn/Zrk6UDy4f3EiARR/OgEUnB/rQiCzE0N3VRsCeQ3ToW2jpi0HUnuWvBxI+8VoWfcpDygwcu1Xd/6dANImQN7111stf3GqBtLuPzW32Yt5V4SygdRvmiXQYOgMIF0VSMFtn2ogt2i4WfaBtBxIAZA6oH4Drq7eIqALuGif27vDtmsaSMdAlmQGKFzhSoC0ERDeBmX37vCX9ABIByC3/cwC0jGQ1Xdrjv3pz0IzoJy9WH7vDhnmK1rQ7WsdgHQp0LASRUDqv1oElHcclO7dEZXLBFIf6LYoOYy9AeUcSef37gBA/mczQFIHFE6i4TYIJ7t3xxIgrQbSCCic2LC9K2p3EVCyd4e4BJXrgOwHHpCGQG4v5bd9mFTUsC2BSsrZlwNQ8NkISBGQVgLp1kBuU5RXbthojocMgby/1wHSXQLpDND4/Qkgb1APSNVBEch9hoBSc3KHQOoOI8dAWgcUvLsnoPkhi4GGofKB3Bt72ovVjbEICE+IQGBCBwSaLrAWUPmM7g1oqONOKPzNFYGGOt4BYvQmgQiUUycHSP9sIJ0C8ibjA5XOGoHArG0MNHU9aHlNzQVafvjVYMDNy00CBa8IBICWTPFegBJFCaTzW14CKYFwKQKBUgQCpQhUX2u3QJs+HeqAQNs+HSoPqH3x+klt/HSoIwKlng5VVW5Bdgq0+dOhVsw6QFs/HWrFrLWbTzwdao3rQevmHo6DVs2aQLP35g+TbwLKKjr/8aKRl9VuNAqBQAgEQqDFIdCyogQi0LKiBCLQHxQCgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCaQ90qfuur/6xXW7kkiruS3uqxgZpDmTuSifvTM+M1n1xkRu5pIr50p6LEaoaG6U1UH9Ff+7xLpPpHkA5jFxS5ev1MRqpch6m0xqo/7rl4qeXnB/+fwVyI5dUcUBVY8M0BzId0Iq/CO06ltkGuZGLqthVrG5slNZA/apfuAEw64QBciOXVbltkivHBtkFkH34ZF0T+56lTwcBqlm8u3GqV7Fh03OIVaxmA3m+9Uh5qdrMuuXlGBvp6l3sqXY333Ncbp0Dd7+brz5IO1UfKNpt0DEOFLsVpv5Uw41cUuUkt2/IrBobhCerIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRDI7oDM0wS7/Py31QOoF2V3QCZ9D6h9hEAgOwYyX7r38esf8/RX8+WWXa8xWf446sLsHujH25Xl53vXo850+O26Sm2Y3QM9qf3x0n3RZavOmbnZPdCLuh99r7q+T+JmORSQ7Q275bwcCqhVv8OSHAko74HLjXMkoG4vpqdtl6NDAXXHQdvuxPYJtKcQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiCQ/wD0DWAfwwTg/QAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="segmentation-for-autocorrelation" class="section level3">
<h3>Segmentation for Autocorrelation</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_Variance</span>(<span class="dv">2</span>, <span class="st">&quot;A3&quot;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;acf&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">92</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>,</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 491 767</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (acf) of each segment</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $acf</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.2988717  0.8969656 -0.4986537</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 2 change-point(s) detected at 90th confidence level based on the change in the single acf parameter.</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 114.870563617187</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 491,767 with a grid_size of 92</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 491,767</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-bivariate-correlation" class="section level3">
<h3>Segmentation for bivariate correlation</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>sigma_cross <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span>,n<span class="sc">/</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span><span class="dv">3</span>,n))</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>rho_sets <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, noCP<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_MTS_Covariance</span>(n, <span class="dv">2</span>, rho_sets, cp_sets, sigma_cross)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[<span class="dv">1</span>][[<span class="dv">1</span>]]</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;bivcor&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">77</span>, </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 336 667</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (bivariate correlation) of each segment</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $bivcor</span></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 0.7862169 0.2308723 0.8062517</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAvVBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZgBmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa225C229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb////AAD/tmb/25D/27b//7b//9v///+EL65EAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMq0lEQVR4nO2dDXvbthHHYa/2am3OmspN1yz22mWt1W1JazaJTdvi9/9YwzsB8OWAIwmB1v2fJ7ZD4g7AT8DhSEEUa0ijYoduQOkiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBAgAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAPa//eSsZNvPor/7hi75r+er9iFLsCPGF0MOdn/587+6Thzj7cF9zfs/D7iaNfdREW2JhATRaROBBmOQ5RPA/T05tRU7TlzjjsFO03qP9p1N1GRrQnFmsr0X9gLHNepgHbMVh04C5rUOTBytOtuoiJbE4rxcifvOM4bSWanGuMAEuKY9X/3v/KX87VE/ocZ/DunB64zc/zzG/771a0p+Lt6zQJzfbT5xA9/9a7tg9M2t3Lx59mt6KJo6udLUe6PDT/kN7JiJ7/Ikg3Qmubz97zeHwIbA0h27nHDttpqOwiIHxc6u7MvLrf1AbXO9PFaz5Jbr0mhuW6oHq9b/0VWbXMqV1Pv5FIBUro0zeg2sq18oDWmoPOnKKIA8QMnP3xoW/R3/bL0AeKnP6rmihL3zSemqLpTzHMmJ/nX9xa/mfUdcxULePO/vX+6sv5Cd7pyUe7ifr9jGtBWeGLvRPGtV44fOPvYHh5qjTigXrTApnGC9Nn7e9WI/3HrAUD88FY2+/SOuzzzQNiSnjN1/ItYiy7cJnXMVUOVRfXNhx53TuW63POVAsQN1U/z0tlylZyb/PDFaGvMuV1o06g86NOlHZOiCJ/4P/cD4lZm+Kmmq1nrRbvAGTf+0Yb4tkkdc3M0XFJad37l58ZSvZbqpwTklBPx5NacHG/NuQ4/vk1jEsX9l5821ojX8Od+QHoCy7qf3qi//t1ZDjxnchCc/evLVfCaheamod2V0rhzKjet7wXkNrIDqL81xl8tBk8ISM1H80KaQcaGRpCTkDz9dKniWguox5kNsD6g0Lx3BHnunMqhEWQb2QHU35rREcT/OnnLz37e2D7JZWAgBvmv8P6fbUTQBUJntZnS2wCQb+7GgvrV+x53buV+DPIBueU6gAZa48egYIrZZKydqNUAIJWXPImAKNcbMVFk9NdLYuM7k8flAiEyGXNANqljblex1zI+Xfe4aysPVjEfkFvO7exIa4JVLABk0nkn+RVDaCwPEh5+bbOFmtk8yHNW60TDdtEc4I0Jzf086KKtuHXnVO7nQQEgp5zb2bHW+HlQGKT3cqXwFqR6AFDz9CMPmOraUVq9En/KtFZfT7rO1HGxbpy9l6uuPPBBNSkw/+Bm0m/bmh13buXC5m8fe2OQW87t7GhrVCb9NpyWzcpvd+yAC805tE5AfCa+dpK5JbVOQCbXsYvDclonoObp+81sN9LGtVJA+USAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQDMDYng9ZLLROhQgvOkDorYHdH2ZAaW/MF2lA2LcBlvhMYwgJkcQssajACRHEAEaq+sBXeNRAKIRBNVFMQiqjFax8bpoBEF1FRekzWcnBj8ufOQjqDKftq3tx26nuPP1AmLQ/sZiqQY+JHHcI+j5yn6Urx6YZMcdg2gEQarMJwEpBg3IPOZg8GNa2UcQXWqM1VXcFFvUHepiFX2P7igSRcbE1XxJgMpKFOVNe+z9jiNY5ll5I2g4UTzETXsRn3kMQr4mxzCCmvKW+bISRVbcCCosUWxEDCoqSC/qDvEuKZNQjwQQ5rqqwBG0Y+xCJotDD36ccO2YfuuivBhUyWcRyYetzBykcfd2WIn3g2r5vIy5l3nGEJ2V21+wFc5esNGJokoR576jqJfsNBs+6ibEvLkLNkuOIJ30pdoUd8PMxiAnp57gzjdL7WyJgBZbxRginuQHJB/3uRsYGnPXG9ohAq6MQRkB8eBSiYdSTiKEHUF6Q2aqVc5lXoQVEWOqSc+2RgPCXJlLQNkSRbGGC0BDC/jM9QZmmM1Qma/mzQjaTXry3hRAiSNIBvacdxRVDKoGF6h56w3tWPJbONkBqZs9Ex+8N20VSwdU2ts+S7nDx6CV3A+aetMes4qZKYbrAmYVY8CbgrPWG5ix9Olir98yAdKatspPjUEphCSgJjugZjfp+bFTR1DiEDpEkD5EoshQgA60ih3iUoPZJTsVELpONKDnqwNMMRwgkztlXsWmPeM7YwwyqQFujq0sUcSMBrOKFQVowQ1UyTmNzoOyTbEYLb6BKi0EZUwUbRo9mkkvvP0lNZqoOwAlTbHCdtqXdzW/5AjSOU2ism6gMtNsJFFcbgMV/qY9tsL0grvz++qiedyM3VFcagOVMJNLdqJRzreexfs9tXhX4wD3pBnm1oWBihPuXY3Hv97Jf3hNA5SaKGYFJCLw83e344AWShQFmOQlOzcgeRm/245OscUSRdzFauZVTNwqe74aW8QWXOax94PQVWZOFCfftMfdPs13P8jp+oiWG0HIK/OcgEa+Tb7VYoki8so85x1FsT7B76outtPeXHgm2+R+63na9qnJdxST86DcF6v1xPcNpyWKSfay9CFuuUa87TNyvYZ/OVM7y8y0zHpHsR69aR9xWw2dSSfnQfbyBDeElolBevGafwSZeJKwzus3GxvkDqHFVjExwBYAZFekVEDYu/bL5EFcO/mN0ssAalKuVvWoS7JxzdMKxmXSUvyCdakg3SAAZRpBKXrcfDUzIGY3cSbEE2cVKwyQCFczA2LtUxRewAia350ZQWkrEub9fLfOuQsu6E7NrYcmMak5VkCxLsyoKy8Gze6OOZca0YCUjaKLqXP2ggu681exOBfM7K1GVrouQO0Iih4QxqZBXmusCpC7iTMakDPqMLVmBsSSOtdv/sBSorQ/6hBVzl5wQXcqjiBHUINbxtYESPWvzYPSYtA6ptgkdxrLgw63aSMIW+vKADXOk1wiJ4xJLrGVzl5wOXd6cX8wwyJyihmbl3+pobHYj3jH+GDsuEZQYzYixK/yTmrw8mNQgwLUtMklotLZC8bpT0LJvxnzf0facUD6d5qd/B3bo6JGUPSEYXaKYTP4dU6x6ItVHxBmJVsVoHYVix0O+rJNb8F78SNI/XQAgV5MseOYYuZi1Qc02mkLKJ4ptqE5AQ11Q/XPLvNstNPe+ZRpmdBQVMHp7ob6wQYBdQ2Cc57NbA3FFUS6Mw3v7/FgZ/sZdU50bdANnVxQKm6nfX83AanPi6WZjEAdt1sKUNxO+/QWy1arjzaldTQdqjZcBlDcPun09qpGm89+pXQzHaoxXQRQ3E779OYqw4euM6CT9mOc6ZWtbwQFn1mNMWgBJde5XAyK2WmP49Pzod7BooZP8qhzXMT2OW0Vi9tpn9rYoLOev8HifTYJVRaTB8UL9alndG0HA4TXcXzffJxT4Py001PNpxWfxykBmnaeABGgaecJEAGadp4AEaBp518+oJckAgSIAAEiQIAIECACBIgAASJAgAgQIAIEiAABIkCACBCg+QHVvU9JkRtntt75/oL9etzoh4tgrPWzM7umMT5mByS+ZrTuVLu/4Ycq0Ud7vr/ggNPze/V9DRjr5yv11bAd0ygfcwNSGxw6X++inodSnd7Z8wMFR5wirfVjx7qmcT7mBmRJ9Lb15NaeHy0YOv3LbeA93rpmW7lXp2sa52N2QLIvAw9C2/FWmfOjBQPVp7+pp2OhrFWxrmmcj7kBqTndP7PFphl7fqxgqEpMkv3NBc5aMeiaxvnICKg2MTod0Il+rV8AoOFxqzZdoSaJihM8ZryAKTYY+Sr3CXqJQVp1gncIZd0UFaSH1k6zew+1zKvdozUySVCASlnmB7Kvx802PJ+SKIo9o/bb7tPTzJISRTFWevL3Sm3rEifs+d6CA6rNhQrGWoeZrmmMD7pYBUSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQMUBsl/Fefpb/NfmLajiAAnZTZsFiAABKhiQ2Db1uPmH2N8qNtrL7WBs+tdRJ6p4QHKH/umd3CpXye8wzUuoeEDbxvy4fr4SbCJ3bs6l4gFdN/aH2i438i2vS2hVgHQCQIBGR1BmrQlQwhcuz6c1AVIfSdjlHUerAiTzoLyLWJmAShIBAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIEAECBABAkSAABEgQAQIEAECRIAAESBABAgQAQJEgAARIED/BxtOVluKFPD5AAAAAElFTkSuQmCC" /><!-- --></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 2 change-point(s) detected at 90th confidence level based on the change in the single bivcor parameter.</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 122.32314655</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 336,667 with a grid_size of 77</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 336,667</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-quantile" class="section level3">
<h3>Segmentation for quantile</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truncnorm)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: package &#39;truncnorm&#39; was built under R version 4.2.3</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(evd)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,n<span class="sc">/</span><span class="dv">2</span>,n)</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="co"># AR time series with no change-point (mean, var)=(0,1)</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, reptime, rho)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>trunc_r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(trunc_r)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>gpd_scale <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>gpd_shape <span class="ot">&lt;-</span> <span class="fl">0.125</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(ts_index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reptime){</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>  ts[(cp_sets[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, ts_index] <span class="ot">&lt;-</span> <span class="fu">mix_GauGPD</span>(<span class="fu">pnorm</span>(ts[(cp_sets[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, ts_index]),</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>p,trunc_r,gpd_scale,gpd_shape)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a><span class="co"># test in 90% quantile</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fl">0.9</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.066</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 487</span></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (90th quantile) of each segment</span></span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quantile</span></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.387091 3.736573</span></span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 1 change-point(s) detected at 90th confidence level based on the change in the 90th quantile.</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 129.82941184</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 487 with a grid_size of 66</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 487</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="test-in-a-general-functional" class="section level3">
<h3>Test in a general functional</h3>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>)),<span class="dv">1</span>))</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, reptime, rho)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,] <span class="sc">+</span> mean_shift[index]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># set a general functional for the input &#39;paras_to_test&#39;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>paras_to_test <span class="ot">=</span> <span class="cf">function</span>(ts){</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mean</span>(ts)</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>result.SNCP.general <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> paras_to_test, </span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, </span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>result.SNCP.general<span class="sc">$</span>est_cp</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 263 365</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (general functional) of each segment</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result.SNCP.general)</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $general</span></span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.3942287 -0.1211077  0.3942779</span></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result.SNCP.general, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result.SNCP.general)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 2 change-point(s) detected at 90th confidence level based on the change in the user-defined functional.</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 141.8941189</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 263,365 with a grid_size of 25</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result.SNCP.general)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 263,365</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.SNCP.general, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="test-in-multiple-parameters" class="section level3">
<h3>Test in multiple parameters</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">333</span>,<span class="dv">667</span>,<span class="dv">1000</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co"># AR time series with no change-point (mean, var)=(0,1)</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, <span class="dv">2</span>, rho)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>sd_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.6</span>,<span class="dv">1</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,]<span class="sc">*</span>sd_shift[index]</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 90th and 95th quantile with grid_size undefined</span></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.95</span>), <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>, </span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 90th quantile and the variance with grid_size undefined</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="st">&#39;variance&#39;</span>),</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">confidence =</span> <span class="fl">0.95</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.078</span>,</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 90th quantile, variance and acf with grid_size undefined</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="st">&#39;variance&#39;</span>, <span class="st">&quot;acf&quot;</span>),</span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.064</span>,</span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 327 659</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 60th quantile, mean, variance and acf with grid_size defined</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>result.last <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&quot;variance&quot;</span>,   </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;acf&quot;</span>), <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size =</span> <span class="dv">83</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>result.last<span class="sc">$</span>est_cp</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 321 660</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (of the last example) of each segment</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result.last)</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $mean</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] -0.04086428  0.08603419  0.03830652</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $variance</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1.031635 2.769062 1.003470</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $acf</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1]  0.0009477774  0.0943055212 -0.0630678502</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $quantile</span></span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;         0.6</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 0.1673911</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2 0.5931716</span></span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 3 0.2747231</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result.last, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result.last)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 2 change-point(s) detected at 90th confidence level based on the change in multiple parameters.</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The parameters being tested are 60th quantile, mean , variance , acf , </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 306.697106637346</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 321,660 with a grid_size of 83</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result.last)</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 321,660</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result.last, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAATlBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6kNtmAABmADpmtrZmtv+QOgCQ2/+2ZgC2/7a2///bkDrb////tmb/25D//7b//9v///8tNpVOAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIx0lEQVR4nO3di1qrOBQF4K2jzrQzao+11rz/i45cAoFcVkgCDXWt7xwvTdjAL9eWUlFMMHLrCag9BAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEUhhIdpNbAZUtt14IBEIgkJ0Dre/8G4CyxrUq0NfLa8lyKWUkd1yrAF2P417y8SO7XM5U1QmkLnJovnEJ8uZ6fPp0AS0//sqcqlqBlDo9vHMJCuYsh82A/NUqBvpZfv4iUDDfb3IDoEllqRpog3IEAgUKAnl63S1Q324D+cZ830DGcRWBzAK/AyiptAZqvxPIV4BAoIALyFz57hDIGo/nAQJ5W0X/UzMgw2RgMoEm2/XgFBm/VwnkF2tbRQNJBJAQSHxAgoHE+aP5exVAc61sIGk7iZIZUKj4nQJJLpBMStvj3RuQBIFE/ToguQHQZFtVEdD41ZjoRUASDyTmQ7MR3xLI+apGCpCI/qZ/8QHJUHhcwuoFcpZbB0jigWQ64sqAJAZoWEtsoMHBWNEygMx/i+Z7LSAxgcQJ1DcMcz8ALAWSvQNJGpDMgSQAJB6gvmoRoOtRnj5PhwQWRzk9xzMgc6ZkZNwF0OXh/fz0eT1mCfmBxAaSRKCxqR9PDJDkAn2/HdQPkDp7LmxJBRILaAJhAkkykEyBxAQy/xQ5QNfjawt0KQEkLiAJApkAUwcANDSYQOIHEnNCFwDpJejUXOBSHEj2D9Rvg87+192XAw2Ljp7M1YD6canxQdWv1uWAuivsHt5zfCwgc/pvACRFgUrEALJmUm+nJxDLgKySASAZgIyR6VWxViBJBXLxbAw0XMJaai8WApo9NAdyDbsAyNGma+QvQXl7eQzkmGzlXn9SgIzO7qWwwCp2el4PyD3rzt4ZQKEaBYDKHChGz2Qm0IKUAgqeany/dSPz9kkDipu5zIwbuiyg6zGwip2lP5O9iOeUNgDkneyNgMZiaUB6LxY402jORjSVp9t4qB87tQV7xY4yDSgizflsn9mWaj72BVNbsFfsKFcDWmMJKp2Y9XU1IDWcyYJt0PoO/rmP6JIAFPFOsEk/74bqXoGKhUCVAcWe1k66JALp1afAkfSCGcqMdfqvrDZ7mESg09Pn+Tn0ZrlqgfS5yuzJAjXvp39OA2pe77k0r2oUeE4azFA+yfS3WCC9uKUCvaqvfz7a/0WAFpyQ7QKoOQq8/vu+IZCx4Yh0M57ONh4JAxlPYfb9EoHa0/jTodwqNvnjzia6azHOr+d4UzvdooHMbbILaHhOcXxkfJ4jfTd/em72ZGWeUTSB5kuNGoGGhX5sWx3Imu9ooBIJAik9D1Mg1T/pmgOkx+gC6mxE5QAZ5+krAE3/wgaQhokB0sseBhp7lQQSyXouOgCkpkDdr5PpHYGUOesRQF1pY4z6D6CUDeSa0Og5ap9MzXxV1ShnA6kZkMoAMrfu41Z30FkHSHWLUd7lUwaQnpcRSCUDqUQgVRhINc/zlNqL6bUoBcjc0JpAKgikjJpTIFUOSBV72UcpC0hFAalEoMlEDPVLA12CT9ovKDcA9b8N65pSU6ChswtoGCgEZM/r/A9QCqjgNmg2/qVAqjCQKgCUtxcbNq1uoOERE2jatBaQNaPeCfTNWvu19HGQrwUDqVgg5QdSawCVPZJGnWwgvewEgNQIpCKACkzooo5Fy8UAGftAJ5AKABWb0P0Aqd8F5BooGWjdCd0fkJp0Wn1CawVSYSD1q4D0oOMM+4DULwcafyaQa1A/kCJQAlDm2Ep33KCcDWQ+7AAqMq5SHTcoJ9MfCRQYWJRVa0dA698NeKdA292y3V+raqDtbtnur1U3kPeW7YnlwgnWqhRoq1u241rVAm1zy/bitdKLL58K1y3brSftS2SvQFvcsr14rfTiSUD+V88IpAgEQyAQAoEQaIvxblwrvTiBtp0KAm1YjkAb1kovTqBtp2LVmSoZAoEQCIRAIDcD2k1uBBRXFLTnNecOnte9TFEC5bUTiEB57QQiUF47gQiU137/QPcUAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAikPdHHeJaX9PIXDpN3d0Z2vl/7mIilD9/fOtAeNqVEc6PIzyos12u+3n4fOzTwO7e6OnqJPn93nNaQMfT22b02yB42qURqou4DR+niX7t0L58ePod3TMVA0cej+tmP2oHE1SgMNEs5pfXgf2oMd50X/fp9Vjx/6Iof2rmP2oHE1igO18+K5EdrpZ6p0e7DjLJfHP93dsZKG7rrZg8bVKA3UrdPuNbt5P97QHuo4z7lZSb7fntOG7gzsQeNqbAh00dvo5UAP/d/6DoD8y233fs6klaTbTvxsM+5gFfNu+c7m+10XbqS7mfiZoaShVVUbad++U3+oS9JuvrvF2iXxIKEDqmU37zn6+no5zNuXHCg2t0lv5yftMLOmA8VmWXEcv5+7y7qahqHd2dGTiz5RSRm638zYg8bU4MkqCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUAIBEIgEAKBEAiEQCAEAiEQCIFACARSHdBw4/zHP6U+Ni8r1QE1GS7arCAEAqkYqLls6uvlv+b61uZC+/ZyMMn/KNiFqR6ovUL/8aO9VO7cfuLAtkLVAx2U/vJ6PTY2eR9GvTjVA72q4Ut3uVzgMxnWyK6A+gMAAgWXoI2zJ6BiH7i8JHsC6t6ScNp2OdoVUHsctO1OrE6gmkIgEAKBEAiEQCAEAiEQCIFACARCIBACgRAIhEAgBAIhEAiBQAgEQiAQAoEQCIRAIAQCIRAIgUD+BxF++HJbs7SOAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>
<div id="examples-snseg_multi" class="section level2">
<h2>Examples: <code>SNSeg_Multi</code></h2>
<p>The function <code>SNSeg_Multi</code> detects change-points for
multivariate time series based on the change in multivariate means or
covariances. Users can set <code>paras_to_test</code> to
<code>mean</code> or <code>covariance</code> for change-points
estimation.</p>
<ul>
<li>The dimension of parameters to be tested must be at most ten. If the
parameter is <code>mean</code>, the dimension is equivalent to the
number of time series. If the parameter is <code>covariance</code>, the
dimension is equivalent to the number of unknown parameters within the
covariance matrix.</li>
</ul>
<p>For examples of multivariate means and covariances, please check the
following commands:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please run this function before running examples:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>exchange_cor_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rho){</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(rho, d, d)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(tmp) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tmp)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="segmentation-for-multivariate-mean" class="section level3">
<h3>Segmentation for Multivariate Mean</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fl">0.075</span>,<span class="fl">0.3</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>)),<span class="dv">1</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>)<span class="sc">/</span><span class="fu">sqrt</span>(d)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">sign</span>(mean_shift)<span class="sc">*</span><span class="fu">ceiling</span>(<span class="fu">abs</span>(mean_shift)<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>rho_sets <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>sigma_cross <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">exchange_cor_matrix</span>(d,<span class="dv">0</span>))</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_MTS_Covariance</span>(n, <span class="dv">2</span>, rho_sets, <span class="at">cp_sets=</span><span class="fu">c</span>(<span class="dv">0</span>,n), sigma_cross)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rep_index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>    tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>    tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>    ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="ot">&lt;-</span> ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="sc">+</span> mean_shift[index]</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[<span class="dv">1</span>][[<span class="dv">1</span>]]</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.95</span>,</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size_scale =</span> <span class="fl">0.079</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.99</span>,</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">65</span>,</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>                      <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 73</span></span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (multivariate mean) of each segment</span></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $multi_mean</span></span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           ts1        ts2        ts3         ts4          ts5</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 1 -1.98767415 -1.2860977 -1.7489535 -1.44241877 -0.854778164</span></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2  0.06754981 -0.1113808  0.1104449 -0.03328591 -0.009844436</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; meanThere are 1 change-points detected at 99th confidence level based on the change in multivariate </span></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 73 with a grid_size of 65</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 535.004482585298</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 73</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-multivariate-covariance" class="section level3">
<h3>Segmentation for Multivariate Covariance</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>sigma_cross <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">exchange_cor_matrix</span>(d,<span class="fl">0.2</span>),</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span><span class="sc">*</span><span class="fu">exchange_cor_matrix</span>(d,<span class="fl">0.5</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">4</span><span class="sc">*</span><span class="fu">exchange_cor_matrix</span>(d,<span class="fl">0.5</span>))</span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>rho_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>)</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># with mean change</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span>,n<span class="sc">/</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span><span class="dv">3</span>,n))</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_MTS_Covariance</span>(n, reptime, rho_sets, cp_sets, sigma_cross)</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rep_index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reptime){</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>    ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="ot">&lt;-</span> ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="sc">+</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>      mean_shift[index]</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[[<span class="dv">1</span>]]</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;covariance&quot;</span>, </span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;covariance&quot;</span>, </span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, </span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size =</span> <span class="dv">81</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>                      <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 321 651</span></span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (covariance estimate) of each segment</span></span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a><span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $covariance</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $covariance[[1]]</span></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.2368168 0.1663240 0.1418070 0.3158124</span></span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 0.1663240 1.1621812 0.2084182 0.2866718</span></span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 0.1418070 0.2084182 1.0752777 0.2100478</span></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 0.3158124 0.2866718 0.2100478 1.1186048</span></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $covariance[[2]]</span></span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]     [,2]      [,3]      [,4]</span></span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 1.976111 1.195347 1.1709615 1.1058696</span></span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 1.195347 2.531295 1.3189884 1.1820544</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 1.170961 1.318988 2.5833800 0.9738675</span></span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 1.105870 1.182054 0.9738675 2.0120061</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $covariance[[3]]</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          [,1]     [,2]     [,3]     [,4]</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1,] 4.188069 2.490367 2.269477 1.858629</span></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [2,] 2.490367 4.793427 2.475150 1.973066</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [3,] 2.269477 2.475150 4.534520 2.201183</span></span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [4,] 1.858629 1.973066 2.201183 4.293322</span></span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; attr(,&quot;class&quot;)</span></span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;SNSeg_estimate&quot;</span></span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; covarianceThere are 2 change-points detected at 90th confidence level based on the change in multivariate </span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 321,651 with a grid_size of 81</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 755.435572948992</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 321,651</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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aFw+AAHQuHwAAqBx+QAEQOPy3z6gtyQAIgRAhACIEAARAiBCAEQIgAgBECEAIgRAhACIEAARqg/oENwlpd2qe2Plhw3Dell3m4uUlO72zvSLpvioDujQVHnwqj2+b5L2IkadHzaMOL15lvdrKCn9et/+dssvmuSjNiB5had3exf584791ZPOjxgOOC0s3W075hdN81EbkCYRbOvqQecPGrpOf//geE8vfWCbdtcxv2iaj+qA2lgiG6Htmlap/EFDR4erX+XuWEWlpZlfNM1HbUDymA4f2eIHizp/yNDVXhwkx/e3ZaUlA79omo8ZAR3UGJ0PaNV91m8AULzfyh+8Fh0kcpxoxow3cIhFR769+YPgzEFaBtEEVFSaL2qQjs2d6n4BRdO83GLtULhIkICWMs1HVl8v642bn7NQFNukt/GULTOXtFAUfSWwft/Ly7pEhs4PGkZ0UCcqJaW7YcYvmuIDJ6uEAIgQABECIEIARAiACAEQIQAiBECEAIgQABECIEIARAiACAEQIQAiBECEAIgQABECIEIARAiACAEQIQAiBECEAIgQABFaHCB9Z4GrX2vdgHqUFgdISF+0uQABEKEFAxKXTb2s/yqubxUX2m+5vIpm7K1gM7V4QO0V+ldP7aVy+/aWDPMSWjygDVcP29d7wWbczaiztXhAW64f5OVyAzetmEJnBahbAGznbMtZAapwM+psnROgsTdcLtI5AZI/SdjN24/OClC7Dpp3ElsmoCUJgAgBECEAIgRAhACIEAARAiBCAEQIgAgBECEAIgRAhACIEAARAiBCAEQIgAgBECEAIgRAhACIEAARAiBC/wc0wFlyl1sDrgAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="examples-snseg_hd" class="section level2">
<h2>Examples: <code>SNSeg_HD</code></h2>
<p>The function <code>SNSeg_HD</code> performs change-points estimation
for high-dimensional time series (dimension greater than 10) using the
change in high-dimensional means. For usage examples of
<code>SNSeg_HD</code>, we provide the followig code:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>nocp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>,nocp<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span>(nocp<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>n)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>num_entry <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">5</span>) <span class="co"># Wang et al(2020)</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,kappa),<span class="dv">100</span>)[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span>)]</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),n,p)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,<span class="dv">1</span><span class="sc">:</span>num_entry] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,<span class="dv">1</span><span class="sc">:</span>num_entry] <span class="sc">+</span></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>    mean_shift[index] <span class="co"># sparse change</span></span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a><span class="co"># SN segmentation plot (plot the first 3 time series)</span></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_HD</span>(ts, <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>,</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_plot =</span> <span class="dv">3</span>)</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_HD</span>(ts, <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale  =</span> <span class="fl">0.05</span>,</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grid_size =</span> <span class="dv">52</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>                   <span class="at">n_plot =</span> <span class="dv">3</span>)</span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 100 195 300 404 498</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter estimates (high-dimensional means) of each segment</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>summary.stat <span class="ot">&lt;-</span> <span class="fu">SNSeg_estimate</span>(result)</span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(result)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; There are 5 change-points detected at 90th confidence level based on the change in high-dimensional means</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 100,195,300,404,498 with a grid_size of 52</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The critical value of SN-based test is 3616.27057754713</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(result)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The detected change-point location(s) are 100,195,300,404,498</span></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(result, <span class="at">cpts.col =</span> <span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v///9fcMrfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMfUlEQVR4nO2dD3vjOBHGp6WFFspxXfbuuJYFDtYHXO8adhfq7kbf/3NhSZYsWZJfyZYTp533edok9sxI84v+xXFsEqxJ0bErsHUxICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAiIAQExICAGBMSAgBgQEAMCYkBADAhIAvryhq7M6/2/bojO/vBQI/b+n4/hhv09XT7lhwith6j7H6+Jvk76NmR1lVtqmD49eYC6QEpnd9k5JPX57fljuGEpICdqK2t6m/SdASiSPt15gHYm5Ci3OWrGQYINWGFiTpAdnb2fLH8AlFlcJH351AHU0Nn33bvUgZQM9z92ML9WFZRPL97L2knrjzfS7j/X3Sbh2XV1/oey7OvXRf/4tnv8vd3wS5/yx2+IfvXtyMcy+He39+JhAGStm6H66qlE5IX621s6H3pI539lQU/WPJW+bKMeIFX487Vsut12qYtH0/bObjQgrRtTV8fOvAVdvftU2tGGHlBv6DwdmkMzbNiPrSOAglBOmxsDStc8mX7fJoY2dvbtT4P5Q2/cpXn1tG96627Lh87ze2l+69nt1BtvN6sh5zdP/U6z4VJt6P5rO9fHAOoCfpA9I7QOutgo1OWD+O/QZwJAyZqn0qdubzhIX/ygx+5b5dTVqDHAFaCuQvq/iu3a7VTj7DZfOal8klPDlQeo39eMfQygu35naB0ACkM5GgNK1zyVPnXd7u/ONC8+3JhW18UwTd0MBY1tb/q/Ksax6+usd+qa79/ZcXIAZOLtxj5uQ9+Zgj3rMaBIqAlA6Zon0+8ef/3GG+b3n/5yLRNqybqb2kcBOXYhIPmeXPz10xsfkInXync8BUjuDK3HgCKhsgG5NU+mrwe2vm62O8pqdC/uhnImW5Bt1wEgO95ttAV5PTKWPunBuq9b9/zsu664j9f+2D0ag/xiXLsAUGsGmNuJMSgANH8MKgL0xe860fRJz43BQlFn2K0KPqsxzZ/F/GJcOzdZ9VzNMXJhceW94/7UEwJKz2IOg9gsVgTIrXkqfdLz/fijhrtKkGX666BRMY6dm6zsxHLZY0s0G4J1UAjI1CFYB+kgjw6gMFQ+IKfmyfSFXuTYiGoY1+tS8fldN1zpT25yVfnVQ3QMcu3cZNXi+0HOYhc/qJlUbfjJXRt/N+6WPaDzX97pgPvAWkd1AQWh8gG5GSbSLzvc0ZR80JytGZ/Z1lMmoEYdV3AWc2vqFAGZRcHkx+daOkVA4vM319UOpCGdJKBXKwYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAKgOik9FhAZWXe2wdGNBa4dYTAwJ65YBwNRjQYotSw6OEmysGBMSAgBgQEAMCYkBADAiIAQEdF1A78YuEGeHWYHo0QA3R7fNX8pfDiUtXlGe7ygGAYwFq5M8j9Y/YEj+Let2AVLt5/q0E1Po/N5l3PIi06wqd7GiA5I/09v8TlVrQoQERtMgOldDOtBuNamm4XEAz+i3cutIgvdPTV0upywuVAqJiQFklHA1Q3XAMCFhAQBQJGtuWWY0TATSYZAOKZDYPEAGL7FCztQRQ6IsATZEl4RiaOK8CEA27EqVRAKj32SygSIL95h5QIl0XkE345QMiZzOpRXj/LOVXE1Ck503rKICGPlUEiMTAN+HR7zs9QE7bXg7Ivgw8DDwXkO3CrwwQZQAaGZ4YIFoIKLaAcgG50Y8OaPpwB00AokxADhgLKCxtAhAdFdB0uDQgygRECUBjl5cKiDIBEQPyAxi7HEDudB4FRMPzVEVBRuoank36+syF4ZyNGYBMto5hLiAn4yQgqgCoPXu/kxdCW0RoZUC0HBDNBbS/v1VHmneLrv5E3oPZ6K18+qZQDojIb0nWZXBMA6LFgORXFhJQWweQW4EEIAoB0RqAxuX4eWdmNLSgZtGFALMBUSVANAJk2mZ9QP0YtEsejy8J509JY0BUDshLsBiQr1HeeRlJqUtzLrwOYBmgoOYBoHGWGFDvsQagGkoCstWaAkSvG5Cb2TQg8y8JiCYAkQMoUsKCWawPUmkWs4NBOSBy2ESawWjQTgOKlrC0BU3N8pZhGuMkIP+dXwWQjb0aINFMXM52f5/iMlShDiCygMJEx9O+AUQuIFoN0ORCcX8PrgZsR53hrYwCcp55mwZA8QzHaA0gigCKOi8HNP1RI33aQhIQvSxAX94sumL0CwZkRuBllxw/BKDw1UG72DIlANEIkEgDojxA3oPoZ/dTA+TXbQRonLGHDQAKDEeAkjpNQBFaiUwFJQDpfxNklgLKWAJWBCRKAQnnsRhQEH4OoGqqBCiRYyEgd/A7LUBiLiDhARJlgMRCQMMd61YBRFmA4soClHKrBqi5fNpdiefrKkcU04BGBiIP0JDrXEBiKSD5fU8rv9WockwaAXLG3zxAYgOA7sTz7x7V3yqAbKoRQIDRXECChv7cf3Im8ipaAEh+q/Hlj+/nAXIrtT1Awxi+BJD6GN/c1utiiX4WByR8oygg4QHSf5NkheFRB5A8VKbu0beADwRkizs8ILEYUA3RkL0zu+YAEp5H6HRcQMmfWNYBFIxRRYDEJgDl31G7DJCYAiTmAOqfIUAaxVCfZYD07Q8r3F3NVkhEAIlhjPYADQTigITZHQKaaD4+ICEWAhK6GS07faoqoMHJhD42IKF+El9jFssHJOYB6u2DLia8p6I+IAG+9skMlwIkIoCs10kAaqsdtA8BCQ+QGTgd1xmAxp3MmR5igMQyQHAMKvjqGQMytXZeI0BiApAY//cACRoiBHlPq2gWS371PA7nABIm3RDQyDUGSCBAtvc6DysAyl0HZX/1rCtlAYkYoLHrPEBiBEh4gIzrckCZK+nMr56FAaQzmAPINEMISEQACRJ1AS2VM0y6lVoISEQAiWxAYkuAIuEgoMA1Cmjk4uRIg+PGAMlDazicA0hsBJDrtiVA9tV0cRqQWA4oMHhpgISfY2VAQUWBDgYIFmUmrVxAjuPrACQqARIhoEjZG5nFvO0YkICARoXol2Y9enqA/O0zAU0V0r/GgGCM5Yal4UJAOb6LAIlXAUgsA+QYMCC/qABQZkVrGZaGmwdI5AAKHU8fUIFvOSDBgHJcNw0ocbijMIh9eHmAIuHKA5P7sAhQfmEVDUvDHRSQsmVAwL2oxOMDmu3LgIAvA8oKMbuH1rbeKqC1/RhQLesZ1al824haITYBaIXbRlQLsQVAa9w2olqIDQBK3zZiVrgKNZrvtxKgureNWF6j+X7rdLHKt42oG2ILgJK3jYgc7ji4NgHo0OHW05qA8r5Z3bgYEBADAjoaoJPRkQChoHP2VA5XmPEqfYIBzQ7KgEBQBgSCMiAQlAGBoAwIBGVAICgDenFiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgoPqApk5A8yUvqKKvN2N98pz1Lb4KnJ6v+2uTFBYkVgDUduW2WWXv7zuznay49clzbtVFjgqc5DVq1e0eCguSqg1If2k2dXsXK33h4d35o/XJc1Y3qxQFTtqivCCl2oBs1rkO3ftoffKcd5d/7gAVOOmT4tzKFdSyOqDJM/QiarrqGp8s585IjkEFTu35z/riWmUFadUGpDt2XvdW9l3FrU+Os+wdElCB005eUExeG6qooF5HBtSaMTq73uZGlSWAzvr2sgVAZV2sVbN8SctXJoVdTI813bizhS5WNEjv9CqoZOzc9Wev3BU4aRAdlC0M0gUTqDC3LC2efZuyaV7/LqDdxjRfsAR7vjbnGZWu35rCheLOAN3AQlF1grwhuu8t0tj65DnrjxoFTq35TFNYkOAPq1AMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBAW0OkL3T5PnPtW5AvUibAyRlz7rcgBgQ0IYByfOenq//JE9QlWfKq3PCaPntqAu1eUDqbPzzR3W+nDwbczjt6jDaPKBbYf7d6ctbLrsZdbE2D+hO2H/6nDl9AubBdFKAzBmuh6zLSQHKPn+/ok4JUPYNl2vqlADp3xQ0h21HJwVIrYMOO4ltE9CWxICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgIAYExICAGBAQAwJiQEAMCIgBATEgoP8DfipMPJ4qybQAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAt1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZmYAZpAAZrY6AAA6ADo6AGY6OgA6OmY6OpA6ZpA6ZrY6kNtmAABmADpmOgBmOjpmkLZmkNtmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQ27aQ29uQ2/+2ZgC2Zjq2ZpC2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b////tmb/25D/27b//7b//9v///9fcMrfAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAMHklEQVR4nO3dD3vdNhUH4JOQQC6UsZRuYykFBvWAZYtpC3Hae77/50J/LFmyJB/Jlm/s3PN7nmU3vpIsvbFl58a1ATmTgefuwNbDQEQYiAgDEWEgIgxEhIGIMBARBiLCQEQYiAgDEWEgIgxEhIGIMBARBiLCQEQYiAgDEWEgIgxEhIGIMBARBiLCQEQYiAgDEWEgIgxEhIGIMBARCfTlNdyY74//egVw8Yf7Gm0f//kQLji+hevH/CbC0kOrxx8PAF8n6zZgc5O71nD48OgBiYZULu6yx5DM5zeXD+GCpUBOq53s6W2y7gygyPDhzgNqTZOjsc1JM24kWEAnHJjTSAsX7yfXPwBlri4yfPnSAWrg4nvxUxKQ0vD4o8D8WnVQvrx6L3snS398Jcv95yAWoVdO9PkfqmTfP9H6xzfi/7+3C37ph/zxG4BffTuqYw3+Ld69uh+AbOlm6L56KYm8pv72Bi6HPUTUv7HQkz1PDV9uox6QWvnTQW66YrnM1YPZ9i5eaSCdV6avTjnzIxD97ofSjRb0QH1B5+WwOTTDguO4dAQoaMrZ5sZA6Z4nh99vE8M2dvHtT0Px+76wGObN47HpS4slH0TN72XxW69cq37wdrGacn7z2L9pFlyrBeKrLufWMUCiwQ9yzwhLB7vYqKnre/zvsM8EQMmep4YP4t1wkr76Qc/dt6qS6FFjwBWQ6JD+qtp2y7Vq4xSLb5yhfJKHhhsPqH+vGdcxQHf9m2HpAChsyskYKN3z1PBB7HZ/dw7z+OGV2epEG2ZTN1NBY7c3/VWtxinX91m/qXt+fGfnyQHItNeO67gbemtW7JUeA0WamgBK9zw5fPH/X7/2pvnjp78c5IA6sNVN76NATrkQSP5Mrv766bUPZNrr5E88BSTfDEuPgSJNZQO5PU8OX09sfd/s7ii7Ib65G9YzuQXZ7ToAsvPdRrcgb4+MDR/0ZN33Tby++E6s7uPBn7tHc5C/GrdcANSZCeZ2Yg4KgObPQUVAX/xdJzp80MfG4ERRj1CcFXxWc5p/FPNX45ZzB6teq2OMPLG48X7i/qEnBEofxRyD2FGsCMjteWr4oI/341813LMEuU7/PGi0GqecO1i5E8vTHrtGsyA4DwqBTB+C8yDdyIMDFDaVD+T0PDl81Cc5tkU1jevzUvz8TkxX+jc3eVb51X10DnLLuYNVJ9/38ih29YM6kqoFP7nnxt+Nd8se6PKXd7rBY1Bat+oCBU3lA7kjTAy/7OOOpuQXzdmZ8TvbeskEatTnCs7J3JrZI5A5KZj89blW9giEn785VPsgjcougc42DESEgYgwEBEGIsJARBiICAMRYSAiDESEgYgwEBEGIsJARBiICAMRYSAiDESEgYgwEBEGIsJARBiICAMRYSAiDESEgYhUBoLd5LmA6ja3XhiICAMReXlAz9XRGevtJi40O3egBuD26Sv5D0IS/yJxdSCotJJ1gBp51bu+NjlxtWsdoFgrvcwiIIi+LO9LKmq7efqtBOr8qwjLTy+KO1UFaOjfSkDy2uvj/7DaFpQongE0C2ltIGzNdqOp5jQHE99NLt4FELb68NVB6l+NnzvQ8uYYiGgYvNcMFCkAzjlNNhCcFRC4QKmtJazGQBN1GYjo1Gwgr9y5A0HkG3CX7BQoPPJTQDmuLwzIr1cVyDF5IUCxoz8YlZcK5PbSAMH6QF5j3qcNOwCCeUBQDGQWe5/H7AgI9AtwC0TaTQPFtwoDBJsACj8wg1lAMJopnPr7BgqbOwUQuG2Pd7vzBYJiIFNua0BuXwIg62J2TQsU/WTbjjQLyL65XyCjMrqawAfyEIYKZtuLAwFGgWBfQHazWQLkFrNzU18JPCBwfyiF494HEESAgAKC3QHZvkfTl4gBhaJZQLBdIGCg6ea2AAQ7ALLHFwco5RMCgRlrFMh37A//sCqQuodnk74/c0FzLxKou3jfyhuhLRLaBBCsAnR8e6suSWgX3f0pCQQ4GyhWgwCCFYDktS0SqKsHBJWAYoX7r0kg8379LahJ3wjQ3rAakrd0nwCCnQP1c1CbvHADJWLKxRvmKYEgD2jcwblHMeo+gMe3xH0U40CQAwQ4/JzNkLcFlJP0lUE5QJALBGbI9YHA62h1oMzmwPYXoQAIHCAL4JGkgOwKwQeKrWYmkJ2BqxzF1gYa6iAOpd3JOJm5QH2WHeUDoGGUtYAQ/Tp27zoREDaLbmdLAUEmEGwXqM6JYi0gSAGZLe30QDV+1bBD8A5F84C8d1NA3gr98rWBvryusIuNgEbTy06BzFFs2S3HtwSUWNFcoDrJBYodvrOAbOtmJX59BnKAzASXC2Smwt0Ced/OAPJrRIEGoUKgjA8ylgP5Qw93kcRIDUwIFKmaAsKFQNVifz1dFwgzgYYJHHcFhD4Qhh4zgEY7pX9iaoBwAdDwxLoZLs5AXKDoUC0QmmFEtiMaCE8N1Fw/tjf4dFj0AFESCFcCwgkgrAIk/97Tyb9qLDpTtECpyWUekD99PBfQHT797kH9d1ogjE24/syFPeIyoL7OTCD5V40vf3xfDygeA4TrAfXTP1YGUr/GN7f1drGKQH27GUDDVtSvAesByY/K1DP6FvjUAxpGWgvI9HAL50GxWTcfCMMXWUD+YRNdIFwKlLwXR2mKgbA2kNl8ET3/xUD5T9TOaG4ayN1qhiojwyiQLRkA4cpA+vGHFZ6uthTIjKoKENpyuBwI9Wa07PKpUiD0gNAONARyGx+AnPOAUwChundSlb+LTQDZQhlAPUYpEK4HhJN/9sm//CUONPTb7fWugLrpD+2Tl78EzRUADR2fD4QBkFfFA4qNO2NEmDUH5V7+UgMItwWUeRTLvPylIlAwWhcIy4FGHSWjCy49D3IQTLNLgYJZ45mB1j+TxnWBzHcxIP9V7Ft6RAWRH4xQzflAtuenAhrPOOFANwGE5lwvCeTWPHOgvt9rAOF+gbAO0KjxAAgZyHsRkDhtmLeeFSinuTEQhkDjmtlA6AONGtkNEFogLALC8wDCAMgumw/krORlA8VrniWQGmx1IMRUgwFQtGepRuP9yi1Y3NwiIMwEwvMBckjcGokuvgQgs8AdLAPFJtRMIKwBlK5zrkCJxVsDcj7ZiLRPDDZ4N6PO3oDSzTEQ0dwcILpg9uqTbzEQ8RYDEW8xEPHWmQLlZ/dAa2czQCuso0oYiMiaQMUPYDsjoHkPYDsfoJkPYDsboPQD2KabOyOgeQ9gOxuguQ9gOx+g5APY0p8HbTWbOg/aYtYEyrl4YfNhICLPBrSbPBMQ1eicdyo3VzhiBiKyyqTBQLMbZSCiUQYiGmUgolEGIhplIKJRBnpxYSAiDESEgYgwEBEGIsJARBiICAMRYSAiDESEgYgwEJH6QFPXV/mRN1TR95uxdfIq60d8FVR6OvT3JilcEa4A1In1dlnrPr4VxVrZcVsnr3KnbnJUUEneo1Y97qFwRTK1gfTfhLIe76JvPNxePtg6eZXVwyqxoJIuUb4ildpAdtS5FcTP0dbJq9xe/1kAFVTS13y5nSvoZXWgyQvQImlEd02drMqikJyDCip1lz/rm2uVrUinNpDesfN2b1VedNzWyaks9w4JVFCplbekk3cXK1pRn2cG6swcnd1v86DKEqCLfnvZAlDZLtapo3zJlq+KFO5ieq4R884WdrGiSbrVZ0Elc2fbX71yV1BJQwiULUzSBQdQNI8sLT76NmWHeX3Ze7eNw3zBKdjTwVxGU3r+1hSeKLYGdAMnimonyJui+71FFrZ18irrXzUKKnXmd5rCFSH/skqGgYgwEBEGIsJARBiICAMRYSAiDESEgYgwEBEGIsJARBiICAMRYSAiDESEgYgwEBEGIsJARBiICAMRYSAiDESEgYgwEJHNAdlnlV7+XOuxeYuyOSAZe9XlBsJARDYMJK97ejr8SV6gKq+UV9eEwfLHURdm80DqavzLB3W9nLwac7js6jTZPNAtmi93+u6NBddg18jmge7QftHXzOkLME+WXQGZK1xP2ZddAWVfv18xewKq9sDlkuwJSP+bgua029GugNR50GkPYtsE2lIYiAgDEWEgIgxEhIGIMBARBiLCQEQYiAgDEWEgIgxEhIGIMBARBiLCQEQYiAgDEWEgIgxEhIGIMBARBiLyf673qFnwvFsfAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- -->
We note that only the first three time series were plotted by setting
<code>n_plot = 3</code>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
