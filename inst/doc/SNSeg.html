<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to SNSeg and Examples</title>

<script src="data:application/javascript;base64,Ly8gUGFuZG9jIDIuOSBhZGRzIGF0dHJpYnV0ZXMgb24gYm90aCBoZWFkZXIgYW5kIGRpdi4gV2UgcmVtb3ZlIHRoZSBmb3JtZXIgKHRvCi8vIGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgYmVoYXZpb3Igb2YgUGFuZG9jIDwgMi44KS4KZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignRE9NQ29udGVudExvYWRlZCcsIGZ1bmN0aW9uKGUpIHsKICB2YXIgaHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCJkaXYuc2VjdGlvbltjbGFzcyo9J2xldmVsJ10gPiA6Zmlyc3QtY2hpbGQiKTsKICB2YXIgaSwgaCwgYTsKICBmb3IgKGkgPSAwOyBpIDwgaHMubGVuZ3RoOyBpKyspIHsKICAgIGggPSBoc1tpXTsKICAgIGlmICghL15oWzEtNl0kL2kudGVzdChoLnRhZ05hbWUpKSBjb250aW51ZTsgIC8vIGl0IHNob3VsZCBiZSBhIGhlYWRlciBoMS1oNgogICAgYSA9IGguYXR0cmlidXRlczsKICAgIHdoaWxlIChhLmxlbmd0aCA+IDApIGgucmVtb3ZlQXR0cmlidXRlKGFbMF0ubmFtZSk7CiAgfQp9KTsK"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<link rel="stylesheet" href="data:text/css,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Introduction to SNSeg and Examples</h1>



<p>SNSeg supports change-points estimation for both univariate and multivariate time series (including high-dimensional time series with dimension greater than 10.) using Self-Normalization (SN) based framework. Please read Zhao, Jiang and Shao (2022) &lt;doi.org/10.1111/rssb.12552&gt; for details of the SN-based algorithms.</p>
<p>The package contain three functions for change-points estimation:</p>
<ul>
<li>The function <code>SNSeg_Uni</code> works for a univariate time series.</li>
<li>The function <code>SNSeg_Multi</code> works for multivariate time series with dimension up to ten.</li>
<li>The function <code>SNSeg_HD</code> works for high-dimensional time series with dimension above ten.</li>
</ul>
<p>All functions contain two important input arguments: <code>grid_size_scale</code> and <code>grid_size</code>.</p>
<ul>
<li><code>grid_size_scale</code>: the trimming parameter <span class="math inline">\(\epsilon\)</span>, a parameter to control the local window size <code>grid_size</code>. The range of <code>grid_size_scale</code> should be between 0.05 and 0.5. Any input <code>grid_size_scale</code> smaller than 0.05 will be automatically changed to 0.05, and any input <code>grid_size_scale</code> greater than 0.5 will be automatically changed to 0.5.</li>
<li><code>grid_size</code>: the local window size <span class="math inline">\(h\)</span> for local scanning for each time point. According to Zhao et al. (2022), <code>grid_size</code> is a product of <code>grid_size_scale</code> and the length of time.</li>
</ul>
<p>Users can set their own <code>grid_size</code> or leave it as <code>NULL</code> in the input arguments. If <code>grid_size</code> is <code>NULL</code>, these functions will compute the SN test statistic using the value of <code>grid_size_scale</code>. If <code>grid_size</code> is set by users, the functions will first calculate <code>grid_size_scale</code> by diving the length of time, and then compute the SN test statistic.</p>
<p>For the other input arguments: * <code>ts</code>: Users should enter a time series for this argument. For <code>SNSeg_Uni</code>, the dimension of <code>ts</code> should be exactly one in most cases (or two when <code>paras_to_test = &#39;bivcor&#39;</code>); for <code>SNSeg_Multi</code>, the dimension must be at least two but no more than ten; for <code>SNSeg_HD</code>, the dimension must be greater than ten. * <code>paras_to_test</code>: This argument in functions <code>SNSeg_Uni</code> and <code>SNSeg_Multi</code> allows users to enter the parameter(s) they would like to test the change in. * <code>confidence</code>: Users should choose a confidence level among 0.9, 0.95, 0.99, 0.995 and 0.995. A smaller confidence level is easier to reject the null hypothesis and detect a change-point.</p>
<p>The package also offers an option to plot the time series (this only works for the univariate time series cases!) Users need to set <code>plot_SN = TRUE</code> to visualize the time series, and <code>est_cp_loc = TRUE</code> to add the estimated change-point locations in the plot.</p>
<div id="sn-test-statistic-plot-max_snsweep" class="section level2">
<h2>SN Test Statistic Plot: <code>max_SNsweep</code></h2>
<p>To visualize the computed SN-based test statistic at each time point, users can apply the function <code>max_SNsweep</code> by plugging in the output object from one of the functions <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code> and <code>SNSeg_HD</code>. The options <code>est_cp_loc = TRUE</code> and <code>critical_loc = TRUE</code> are provided to draw the estimated change-point locations and the critical value threshold inside the test statistic plot.</p>
<p><code>max_SNsweep</code> also returns the SN-based test statistic for each time point. A large number of test statistics in the output can be messy for users who only seek to generate a plot. To hide the test statistics output, users can create an arbitrary variable name and set it to the <code>max_SNsweep</code> function, e.g., <code>SN_stat &lt;- max_SNsweep(...)</code>.</p>
<p>We then provide the examples of the functions <code>SNSeg_Uni</code>, <code>SNSeg_Multi</code> and <code>SNSeg_HD</code>.</p>
</div>
<div id="examples-of-snseg_uni" class="section level2">
<h2>Examples of <code>SNSeg_Uni</code>:</h2>
<p>The function <code>SNSeg_Uni</code> detect change-points for a univariate time series based on the change in a single or parameters.</p>
<ul>
<li>For a univariate time series, the input argument <code>paras_to_test</code> allows one or a combination of multiple parameters from “mean”, “variance”, “acf” and a numeric quantile value between 0 and 1. For instance, to test the change in autocorrelation and 80th quantile, users should set <code>paras_to_test</code> to c(‘acf’, 0.8).</li>
<li>To test the change in correlation between two univariate time series, the input time series must be two-dimensional and <code>paras_to_test</code> should be set to <code>bivcor</code>.</li>
</ul>
<p>We then provide examples for different cases:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please run the following function before running examples:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mix_GauGPD <span class="ot">&lt;-</span> <span class="cf">function</span>(u,p,trunc_r,gpd_scale,gpd_shape){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  indicator <span class="ot">&lt;-</span> u<span class="sc">&lt;</span>p</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  rv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, <span class="fu">length</span>(u))</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  rv[indicator<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">qtruncnorm</span>(u[indicator<span class="sc">&gt;</span><span class="dv">0</span>]<span class="sc">/</span>p,<span class="at">a=</span><span class="sc">-</span><span class="cn">Inf</span>,<span class="at">b=</span>trunc_r)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  rv[indicator<span class="sc">&lt;=</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">qgpd</span>((u[indicator<span class="sc">&lt;=</span><span class="dv">0</span>]<span class="sc">-</span>p)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>p), <span class="at">loc=</span>trunc_r, <span class="at">scale=</span>gpd_scale,<span class="at">shape=</span>gpd_shape)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(rv)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="test-in-a-single-parameter" class="section level2">
<h2>Test in a single parameter</h2>
<div id="segmentation-for-mean" class="section level3">
<h3>Segmentation for Mean</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fl">0.5</span>,<span class="fl">0.25</span>)),<span class="dv">1</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.4</span>,<span class="dv">0</span>,<span class="fl">0.4</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fl">0.7</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, reptime, rho)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span>   </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,] <span class="sc">+</span> mean_shift[index]</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>, </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined &amp; generate time series segmentation plot</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">116</span>, </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 1018 1487</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-variance" class="section level3">
<h3>Segmentation for Variance</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_Variance</span>(<span class="dv">2</span>, <span class="st">&quot;V1&quot;</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;variance&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">67</span>, </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 407 740</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-autocorrelation" class="section level3">
<h3>Segmentation for Autocorrelation</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_Variance</span>(<span class="dv">2</span>, <span class="st">&quot;A3&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;acf&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">92</span>, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 491 767</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-bivariate-correlation" class="section level3">
<h3>Segmentation for bivariate correlation</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>sigma_cross <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="dv">4</span><span class="sc">*</span><span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>),</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">1</span>), <span class="at">nrow=</span><span class="dv">2</span>))</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span>,n<span class="sc">/</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span><span class="dv">3</span>,n))</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>rho_sets <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fl">0.5</span>, noCP<span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_MTS_Covariance</span>(n, <span class="dv">2</span>, rho_sets, cp_sets, sigma_cross)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[<span class="dv">1</span>][[<span class="dv">1</span>]]</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;bivcor&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">77</span>, </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 336 667</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-quantile" class="section level3">
<h3>Segmentation for quantile</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(truncnorm)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(evd)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,n<span class="sc">/</span><span class="dv">2</span>,n)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># AR time series with no change-point (mean, var)=(0,1)</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, reptime, rho)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>trunc_r <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(trunc_r)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>gpd_scale <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>gpd_shape <span class="ot">&lt;-</span> <span class="fl">0.125</span></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(ts_index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reptime){</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  ts[(cp_sets[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, ts_index] <span class="ot">&lt;-</span> <span class="fu">mix_GauGPD</span>(<span class="fu">pnorm</span>(ts[(cp_sets[<span class="dv">2</span>]<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n, ts_index]),</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>p,trunc_r,gpd_scale,gpd_shape)</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a><span class="co"># test in 90% quantile</span></span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fl">0.9</span>, <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.066</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>,</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 487</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the SN-based test statistic</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>SN_stat <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="test-in-multiple-parameters" class="section level3">
<h3>Test in multiple parameters</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">7</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">333</span>,<span class="dv">667</span>,<span class="dv">1000</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="co"># AR time series with no change-point (mean, var)=(0,1)</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR</span>(n, <span class="dv">2</span>, rho)<span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>sd_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">1.6</span>,<span class="dv">1</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,]<span class="sc">*</span>sd_shift[index]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[,<span class="dv">2</span>]</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 90th and 95th quantile with grid_size undefined</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.95</span>), <span class="at">confidence =</span> <span class="fl">0.9</span>,</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>, </span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 90th quantile and the variance with grid_size undefined</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="st">&#39;variance&#39;</span>),</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>                    <span class="at">confidence =</span> <span class="fl">0.95</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.078</span>,</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">FALSE</span>, </span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est_cp_loc =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 90th quantile, variance and acf with grid_size undefined</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.9</span>,<span class="st">&#39;variance&#39;</span>, <span class="st">&quot;acf&quot;</span>),</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                    <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.064</span>,</span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size =</span> <span class="cn">NULL</span>, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>                    <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 327 659</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Test in 60th quantile, mean, variance and acf with grid_size defined</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Uni</span>(ts, <span class="at">paras_to_test =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="st">&#39;mean&#39;</span>, <span class="st">&quot;variance&quot;</span>,   </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                    <span class="st">&quot;acf&quot;</span>), <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                    <span class="at">grid_size =</span> <span class="dv">83</span>, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 321 660</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>SN_stst <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="examples-snseg_mulni" class="section level2">
<h2>Examples: <code>SNSeg_Mulni</code></h2>
<p>The function <code>SNSeg_Multi</code> detects change-points for multivariate time series based on the change in multivariate means or covariances. Users can set <code>paras_to_test</code> to <code>mean</code> or <code>covariance</code> for change-points estimation.</p>
<ul>
<li>The dimension of parameters to be tested must be at most ten. If the parameter is <code>mean</code>, the dimension is equivalent to the number of time series. If the parameter is <code>covariance</code>, the dimension is equivalent to the number of unknown parameters within the covariance matrix.</li>
</ul>
<p>For examples of multivariate means and covariances, please check the following commands:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Please run this function before running examples:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>exchange_cor_matrix <span class="ot">&lt;-</span> <span class="cf">function</span>(d, rho){</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  tmp <span class="ot">&lt;-</span> <span class="fu">matrix</span>(rho, d, d)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">diag</span>(tmp) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(tmp)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div id="segmentation-for-multivariate-mean" class="section level3">
<h3>Segmentation for Multivariate Mean</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(n<span class="sc">*</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="fu">cumsum</span>(<span class="fu">c</span>(<span class="fl">0.075</span>,<span class="fl">0.3</span>,<span class="fl">0.05</span>,<span class="fl">0.1</span>,<span class="fl">0.05</span>)),<span class="dv">1</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>,<span class="dv">3</span>,<span class="dv">0</span>,<span class="sc">-</span><span class="dv">3</span>,<span class="dv">0</span>)<span class="sc">/</span><span class="fu">sqrt</span>(d)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">sign</span>(mean_shift)<span class="sc">*</span><span class="fu">ceiling</span>(<span class="fu">abs</span>(mean_shift)<span class="sc">*</span><span class="dv">10</span>)<span class="sc">/</span><span class="dv">10</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>rho_sets <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>sigma_cross <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">exchange_cor_matrix</span>(d,<span class="dv">0</span>))</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_MTS_Covariance</span>(n, <span class="dv">2</span>, rho_sets, <span class="at">cp_sets=</span><span class="fu">c</span>(<span class="dv">0</span>,n), sigma_cross)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rep_index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>){</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>    tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>    tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>    ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="ot">&lt;-</span> ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="sc">+</span> mean_shift[index]</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[<span class="dv">1</span>][[<span class="dv">1</span>]]</span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.95</span>,</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size_scale =</span> <span class="fl">0.079</span>, <span class="at">grid_size =</span> <span class="cn">NULL</span>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">confidence =</span> <span class="fl">0.99</span>,</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, <span class="at">grid_size =</span> <span class="dv">65</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 73</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>SN_stst <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="segmentation-for-multivariate-covariance" class="section level3">
<h3>Segmentation for Multivariate Covariance</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>reptime <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>sigma_cross <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">exchange_cor_matrix</span>(d,<span class="fl">0.2</span>),</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span><span class="sc">*</span><span class="fu">exchange_cor_matrix</span>(d,<span class="fl">0.5</span>),</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">4</span><span class="sc">*</span><span class="fu">exchange_cor_matrix</span>(d,<span class="fl">0.5</span>))</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>rho_sets <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.3</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>)</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>) <span class="co"># with mean change</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">c</span>(<span class="dv">0</span>,n<span class="sc">/</span><span class="dv">3</span>,<span class="dv">2</span><span class="sc">*</span>n<span class="sc">/</span><span class="dv">3</span>,n))</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">MAR_MTS_Covariance</span>(n, reptime, rho_sets, cp_sets, sigma_cross)</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>noCP <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">2</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(rep_index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>reptime){</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>    tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>    tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>    ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="ot">&lt;-</span> ts[[rep_index]][,tau1<span class="sc">:</span>tau2] <span class="sc">+</span></span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a>      mean_shift[index]</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> ts[[<span class="dv">1</span>]]</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;covariance&quot;</span>, </span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, </span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size =</span> <span class="cn">NULL</span>)</span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_Multi</span>(ts, <span class="at">paras_to_test =</span> <span class="st">&quot;covariance&quot;</span>, </span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>                      <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>, </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>                      <span class="at">grid_size =</span> <span class="dv">81</span>)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 321 651</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>SN_stst <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="examples-snseg_hd" class="section level2">
<h2>Examples: <code>SNSeg_HD</code></h2>
<p>The function <code>SNSeg_HD</code> performs change-points estimation for high-dimensional time series (dimension greater than 10) using the change in high-dimensional means. For usage examples of <code>SNSeg_HD</code>, we provide the followig code:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">600</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>nocp <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>cp_sets <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>,nocp<span class="sc">+</span><span class="dv">1</span>,<span class="dv">1</span>)<span class="sc">/</span>(nocp<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>n)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>num_entry <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>kappa <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">4</span><span class="sc">/</span><span class="dv">5</span>) <span class="co"># Wang et al(2020)</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>mean_shift <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>,kappa),<span class="dv">100</span>)[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span>)]</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n<span class="sc">*</span>p,<span class="dv">0</span>,<span class="dv">1</span>),n,p)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>no_seg <span class="ot">&lt;-</span> <span class="fu">length</span>(cp_sets)<span class="sc">-</span><span class="dv">1</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>no_seg){ <span class="co"># Mean shift</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  tau1 <span class="ot">&lt;-</span> cp_sets[index]<span class="sc">+</span><span class="dv">1</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>  tau2 <span class="ot">&lt;-</span> cp_sets[index<span class="sc">+</span><span class="dv">1</span>]</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>  ts[tau1<span class="sc">:</span>tau2,<span class="dv">1</span><span class="sc">:</span>num_entry] <span class="ot">&lt;-</span> ts[tau1<span class="sc">:</span>tau2,<span class="dv">1</span><span class="sc">:</span>num_entry] <span class="sc">+</span></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>    mean_shift[index] <span class="co"># sparse change</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size undefined</span></span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_HD</span>(ts, <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale =</span> <span class="fl">0.05</span>,</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grid_size =</span> <span class="cn">NULL</span>)</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a><span class="co"># grid_size defined</span></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">SNSeg_HD</span>(ts, <span class="at">confidence =</span> <span class="fl">0.9</span>, <span class="at">grid_size_scale  =</span> <span class="fl">0.05</span>,</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">grid_size =</span> <span class="dv">52</span>)</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimated change-point locations</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>result<span class="sc">$</span>est_cp</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 100 195 300 404 498</span></span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a><span class="co"># SN-based test statistic segmentation plot</span></span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>SN_stst <span class="ot">&lt;-</span> <span class="fu">max_SNsweep</span>(result, <span class="at">plot_SN =</span> <span class="cn">TRUE</span>, <span class="at">est_cp_loc =</span> <span class="cn">TRUE</span>,</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a>                       <span class="at">critical_loc =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
